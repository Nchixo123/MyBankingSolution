@model BankingSystem.Application.Dtos.AccountDto

@{
    ViewData["Title"] = "Account Details";
}

<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2><i class="bi bi-file-earmark-text"></i> Account Details</h2>
        <a asp-controller="Account" asp-action="MyAccounts" class="btn btn-outline-secondary">
            <i class="bi bi-arrow-left"></i> Back to Accounts
        </a>
    </div>

    @if (TempData["SuccessMessage"] != null)
    {
        <div class="alert alert-success alert-dismissible fade show" role="alert">
            @TempData["SuccessMessage"]
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    }

    @if (TempData["ErrorMessage"] != null)
    {
        <div class="alert alert-danger alert-dismissible fade show" role="alert">
            @TempData["ErrorMessage"]
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    }

    <div class="row">
        <div class="col-lg-4 mb-4">
            <div class="card shadow-sm">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0"><i class="bi bi-info-circle"></i> Account Information</h5>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <small class="text-muted">Account Number</small>
                        <h6 class="mb-0">@Model.AccountNumber</h6>
                    </div>
                    <div class="mb-3">
                        <small class="text-muted">Account Type</small>
                        <h6 class="mb-0">@Model.AccountType.ToString()</h6>
                    </div>
                    <div class="mb-3">
                        <small class="text-muted">Current Balance</small>
                        <h4 class="text-success mb-0">@Model.Balance.ToString("C")</h4>
                    </div>
                    <div class="mb-3">
                        <small class="text-muted">Currency</small>
                        <p class="mb-0">@Model.Currency</p>
                    </div>
                    <div class="mb-3">
                        <small class="text-muted">Status</small>
                        <div>
                            @if (Model.Status == BankingSystem.Domain.Entities.Enums.AccountStatus.Active)
                            {
                                <span class="badge bg-success">Active</span>
                            }
                            else if (Model.Status == BankingSystem.Domain.Entities.Enums.AccountStatus.Inactive)
                            {
                                <span class="badge bg-secondary">Inactive</span>
                            }
                            else if (Model.Status == BankingSystem.Domain.Entities.Enums.AccountStatus.Frozen)
                            {
                                <span class="badge bg-warning text-dark">Frozen</span>
                            }
                            else if (Model.Status == BankingSystem.Domain.Entities.Enums.AccountStatus.Closed)
                            {
                                <span class="badge bg-danger">Closed</span>
                            }
                        </div>
                    </div>
                    <div class="mb-3">
                        <small class="text-muted">Account Opened</small>
                        <p class="mb-0">@Model.CreatedAt.ToString("MMMM dd, yyyy")</p>
                    </div>
                </div>
            </div>

            <div class="card shadow-sm mt-3">
                <div class="card-header bg-info text-white">
                    <h5 class="mb-0"><i class="bi bi-lightning"></i> Quick Actions</h5>
                </div>
                <div class="card-body d-grid gap-2">
                    <a asp-controller="Transaction" asp-action="Deposit" asp-route-accountNumber="@Model.AccountNumber" class="btn btn-success">
                        <i class="bi bi-arrow-down-circle"></i> Deposit
                    </a>
                    <a asp-controller="Transaction" asp-action="Withdraw" asp-route-accountNumber="@Model.AccountNumber" class="btn btn-warning">
                        <i class="bi bi-arrow-up-circle"></i> Withdraw
                    </a>
                    <a asp-controller="Transaction" asp-action="Transfer" asp-route-fromAccountNumber="@Model.AccountNumber" class="btn btn-primary">
                        <i class="bi bi-arrow-left-right"></i> Transfer
                    </a>
                </div>
            </div>
        </div>

        <div class="col-lg-8">
            <div class="card shadow-sm">
                <div class="card-header bg-secondary text-white">
                    <h5 class="mb-0"><i class="bi bi-clock-history"></i> Recent Transactions</h5>
                </div>
                <div class="card-body">
                    <div id="transactionsContainer">
                        <p class="text-center text-muted py-4">
                            <i class="bi bi-hourglass-split fs-3 d-block mb-2"></i>
                            Loading transactions...
                        </p>
                    </div>
                    <div class="text-center mt-3">
                        <a asp-controller="Transaction" asp-action="History" asp-route-accountNumber="@Model.AccountNumber" class="btn btn-outline-primary">
                            View All Transactions
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // This would typically load recent transactions via AJAX
        // For now, we'll show a placeholder message
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(function() {
                const container = document.getElementById('transactionsContainer');
                container.innerHTML = `
                    <div class="alert alert-info" role="alert">
                        <i class="bi bi-info-circle"></i> 
                        Click "View All Transactions" to see your transaction history.
                    </div>
                `;
            }, 1000);
        });
    </script>
}
